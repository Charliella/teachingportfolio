<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SPICEï¼šç•°å¸¸è£‚ç¸«çµ‚ç«¯ (æœ€çµ‚ä¿®å¾©ç‰ˆ)</title>
    <style>
        :root {
            --paper: #f4e4bc; --ink: #3a2e24; --accent: #8b5cf6;
            --panel-bg: rgba(18, 20, 28, 0.95); --text-light: #e2e8f0;
            --success: #4ade80; --fail: #f87171; --tab-active: #8b5cf6;
        }
        body, html { margin: 0; padding: 0; height: 100%; background: #050508; color: var(--text-light); font-family: 'Courier New', 'PingFang TC', serif; overflow-x: hidden; }
        
        nav { background: #000; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--accent); position: sticky; top: 0; z-index: 100; }
        .logo { font-weight: 900; letter-spacing: 5px; color: var(--accent); cursor: pointer; }
        .nav-links button { background: none; border: 1px solid var(--accent); color: white; padding: 8px 16px; cursor: pointer; border-radius: 4px; margin-left: 10px; transition: 0.3s; }
        .nav-links button:hover { background: var(--accent); }

        .view-section { display: none; padding: 20px; min-height: 90vh; }
        .active { display: block; }

        /* é—œä¸»å€ä½ˆå±€ */
        .gm-layout { display: grid; grid-template-columns: 1fr 350px; gap: 20px; height: calc(100vh - 150px); }
        @media (max-width: 1024px) { .gm-layout { grid-template-columns: 1fr; height: auto; } }

        /* ç•«å¸ƒèˆ‡åˆ†é  */
        .canvas-container { 
            position: relative; height: 600px; background-color: var(--paper);
            background-image: url('https://www.transparenttextures.com/patterns/old-map.png');
            border: 4px double #8b5a2b; border-radius: 8px; overflow: hidden; touch-action: none;
        }
        canvas { width: 100%; height: 100%; cursor: crosshair; }
        .gm-page-tabs { display: flex; gap: 2px; margin-bottom: 5px; overflow-x: auto; }
        .page-btn { padding: 8px 15px; background: #1e293b; border: 1px solid #334155; color: #94a3b8; cursor: pointer; }
        .page-btn.active { background: var(--tab-active); color: white; border-color: var(--tab-active); }

        /* æ£‹å­æ¨£å¼ */
        .token {
            position: absolute; width: 42px; height: 42px; border-radius: 50%;
            background: var(--accent); color: white; display: flex; align-items: center;
            justify-content: center; font-weight: bold; cursor: move; border: 2px solid white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.5); z-index: 50; user-select: none;
        }

        .toolbar { position: absolute; top: 10px; left: 10px; display: flex; flex-wrap: wrap; gap: 8px; z-index: 60; }
        .toolbar button { background: #3a2e24; color: #f4e4bc; border: none; padding: 8px 12px; cursor: pointer; border-radius: 3px; }

        /* éª°å­é¢æ¿ */
        .dice-panel { background: #161821; padding: 25px; border-radius: 12px; border: 1px solid #334155; }
        .check-setting { margin: 15px 0; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px; }

        /* è§’è‰²å¡ç‰‡ (æ¢å¾©è‡³ system2.html ç‰ˆæœ¬) */
        .char-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 25px; margin-top: 20px; }
        .char-card { background: var(--panel-bg); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 12px; padding: 25px; position: relative; }
        .spice-bar { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0; }
        .spice-item { text-align: center; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 6px; border: 1px solid #2d3748; }
        .spice-label { font-size: 0.75rem; color: #94a3b8; margin-bottom: 4px; }
        .spice-val { font-size: 1.2rem; font-weight: bold; color: var(--accent); }
        .char-bio-section { font-size: 0.9rem; line-height: 1.6; color: #cbd5e1; border-top: 1px dashed #444; margin-top: 15px; padding-top: 15px; }
        .bio-label { color: var(--accent); font-weight: bold; display: block; margin-bottom: 5px; }

        /* Modal & Editor */
        #edit-modal { 
            display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: #1e1b4b; padding: 30px; border-radius: 16px; z-index: 1000; width: 90%; max-width: 500px;
            max-height: 90vh; overflow-y: auto; border: 2px solid var(--accent); box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0 18px; background: #000; color: white; border: 1px solid #444; border-radius: 8px; box-sizing: border-box; font-family: inherit; }
        
        #log-editor-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 2000; padding: 30px; box-sizing: border-box; }
        #full-log-textarea { width: 100%; height: calc(100% - 100px); background: #111; color: #eee; padding: 25px; border: 1px solid var(--accent); font-size: 1.1rem; line-height: 1.8; resize: none; border-radius: 10px; }
    </style>
</head>
<body>

<nav>
    <div class="logo" onclick="showView('home')">SPICE TERMINAL</div>
    <div class="nav-links">
        <button onclick="showView('gm-zone')">ğŸ› ï¸ é—œä¸»å€</button>
        <button onclick="showView('char-zone')">ğŸ‘¥ èª¿æŸ¥å“¡</button>
        <button onclick="showView('log-zone')">ğŸ“– å†’éšªæ—¥èªŒ</button>
    </div>
</nav>

<section id="home" class="view-section active" style="text-align: center; padding-top: 120px;">
    <h1 style="font-size: 4rem; color: var(--accent); letter-spacing: 15px; margin-bottom: 0;">SPICE</h1>
    <p style="opacity: 0.6; margin-top: 10px;">Strategic Paranormal Investigation & Crisis Evaluation</p>
    <button onclick="showView('gm-zone')" style="margin-top:50px; padding: 20px 50px; background: var(--accent); border: none; color: white; font-weight: bold; cursor: pointer; border-radius: 40px; font-size: 1.2rem;">å•Ÿå‹•çµ‚ç«¯ç³»çµ±</button>
</section>

<section id="gm-zone" class="view-section">
    <div class="gm-page-tabs" id="pageTabs"></div>
    <div class="gm-layout">
        <div class="main-column">
            <div class="canvas-container" id="canvasWrap">
                <div class="toolbar">
                    <button onclick="window.currentTool='pen'">ğŸ–‹ï¸ ç•«ç­†</button>
                    <button onclick="window.currentTool='text'">ğŸ”  æ‰“å­—</button>
                    <button onclick="window.clearCanvas()">ğŸ§¹ æ¸…ç©ºæœ¬é </button>
                    <input type="color" id="inkColor" value="#3a2e24" style="width:35px; height:35px; border:none; padding:0; cursor:pointer;">
                    <span style="border-left:1px solid #8b5a2b; margin: 0 10px;"></span>
                    <button style="background:#6d28d9" onclick="addToken('ä¿®')">ä¿®</button>
                    <button style="background:#6d28d9" onclick="addToken('æ—»')">æ—»</button>
                    <button style="background:#6d28d9" onclick="addToken('åº­')">åº­</button>
                    <button style="background:#6d28d9" onclick="addToken('æ¢“')">æ¢“</button>
                    <button style="background:#6d28d9" onclick="addToken('å²±')">å²±</button>
                    <button style="background:#6d28d9" onclick="addToken('ç¥')">ç¥</button>
                </div>
                <canvas id="mainCanvas"></canvas>
                <div id="tokenLayer"></div>
            </div>
        </div>

        <div class="dice-panel">
            <h3 style="margin-top:0; color:var(--accent);">æ©Ÿç‡è§£æ§‹</h3>
            <label>éª°å­ç¨®é¡</label>
            <select id="diceType"><option value="100">D100 (ç™¾åˆ†éª°)</option><option value="20">D20</option><option value="6">D6</option></select>
            
            <div class="check-setting">
                <label style="display:flex; align-items:center; cursor:pointer; margin-bottom:10px;">
                    <input type="checkbox" id="useTarget" checked style="width:20px; height:20px; margin-right:12px;"> å•Ÿç”¨ç›®æ¨™å€¼æª¢å®š
                </label>
                <label>ç›®æ¨™æ•¸å€¼ (â‰¤ ç‚ºæˆåŠŸ)</label>
                <input type="number" id="targetVal" value="50">
            </div>

            <button onclick="window.rollDice()" style="width:100%; padding:18px; background:var(--accent); color:white; border:none; cursor:pointer; font-weight:bold; border-radius:10px; font-size:1.1rem;">åŸ·è¡ŒæŠ•æ“²</button>
            <div id="resNum" style="font-size:5rem; text-align:center; font-weight:bold; margin:20px 0; color:white;">--</div>
            <div id="resTag" style="text-align:center; font-size:1.5rem; min-height:1.5em; font-weight:bold;">ç­‰å¾…æŒ‡ä»¤</div>
        </div>
    </div>
</section>

<section id="char-zone" class="view-section">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2 style="color:var(--accent);">èª¿æŸ¥å“¡åå†Š</h2>
        <button onclick="window.checkAdmin(window.openCharCreate)" style="background:var(--accent); border:none; color:white; padding:12px 25px; border-radius:6px; font-weight:bold;">+ æ–°å¢èª¿æŸ¥å“¡</button>
    </div>
    <div class="char-grid" id="charGrid"></div>
</section>

<section id="log-zone" class="view-section">
    <h2 style="color:var(--accent);">å†’éšªæ—¥èªŒ</h2>
    <div id="log-content" style="background: rgba(255,255,255,0.05); padding: 35px; border-radius: 15px; min-height: 400px; white-space: pre-wrap; border: 1px solid #334155; line-height:2; font-size:1.1rem;"></div>
    <button onclick="window.checkAdmin(window.openLogEditor)" style="margin-top:30px; background:var(--accent); border: none; color: white; padding: 15px 40px; border-radius: 8px; font-weight: bold;">ç·¨è¼¯æ—¥èªŒå…§å®¹</button>
</section>

<div id="edit-modal">
    <h3 id="modal-title" style="margin-top:0; color:var(--accent);">è§’è‰²æª”æ¡ˆç·¨è¼¯</h3>
    <label>èª¿æŸ¥å“¡å§“å</label>
    <input type="text" id="c-name" placeholder="è«‹è¼¸å…¥å§“å">
    
    <label>æ ¸å¿ƒå±¬æ€§ (SPICE)</label>
    <div style="display:grid; grid-template-columns: repeat(5, 1fr); gap:10px;">
        <div><small>Sé«”åŠ›</small><input type="number" id="c-s"></div>
        <div><small>Pæ„ŸçŸ¥</small><input type="number" id="c-p"></div>
        <div><small>Iæ™ºæ…§</small><input type="number" id="c-i"></div>
        <div><small>Cå‹‡æ°£</small><input type="number" id="c-c"></div>
        <div><small>Eæƒ…æ„Ÿ</small><input type="number" id="c-e"></div>
    </div>

    <label>æ€§æ ¼ç‰¹è³ª</label>
    <textarea id="c-personality" rows="3"></textarea>
    <label>èƒŒæ™¯æ•…äº‹</label>
    <textarea id="c-background" rows="3"></textarea>
    <label>éš¨èº«è£å‚™/ç‰¹è³ª</label>
    <textarea id="c-traits" rows="2"></textarea>

    <button id="save-btn" style="width:100%; padding:15px; background:var(--accent); border:none; color:white; font-weight:bold; border-radius:8px; font-size:1rem; cursor:pointer;">æ›´æ–°é›²ç«¯è³‡æ–™</button>
    <button onclick="window.closeModal()" style="width:100%; background:none; color:#94a3b8; border:none; margin-top:10px; cursor:pointer;">å–æ¶ˆè¿”å›</button>
</div>

<div id="log-editor-overlay">
    <div style="max-width:1000px; margin:auto; height:100%; display:flex; flex-direction:column;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h2 style="margin:0; color:var(--accent);">ç·¨è¼¯å†’éšªæ—¥èªŒ</h2>
            <div>
                <button onclick="window.closeLogEditor()" style="background:#444; color:white; border:none; padding:12px 25px; border-radius:6px;">å–æ¶ˆ</button>
                <button onclick="window.saveLog()" style="background:var(--success); color:black; border:none; padding:12px 30px; border-radius:6px; font-weight:bold; margin-left:15px;">å„²å­˜ä¸¦åŒæ­¥</button>
            </div>
        </div>
        <textarea id="full-log-textarea" placeholder="åœ¨æ­¤è¨˜éŒ„é€™æ®µå‚³å¥‡å†’éšª..."></textarea>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
    import { getFirestore, doc, setDoc, onSnapshot, collection, deleteDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js";

    const firebaseConfig = { apiKey: "AIzaSyAtDx1dYH-vAKIN3iTrkqya52gZkjM9bTk", authDomain: "spice-8eb9f.firebaseapp.com", projectId: "spice-8eb9f", storageBucket: "spice-8eb9f.firebasestorage.app", messagingSenderId: "244211683384", appId: "1:244211683384:web:85662dc29c17f7fee916cd" };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // --- ç•«å¸ƒåˆ†é èˆ‡æ£‹å­ (ç¶­æŒé—œä¸»å€éœ€æ±‚) ---
    let currentPage = 0;
    let pageData = Array.from({length: 10}, () => ({ img: null, tokens: [] }));
    const canvas = document.getElementById('mainCanvas');
    const ctx = canvas.getContext('2d');
    const tokenLayer = document.getElementById('tokenLayer');
    let isDrawing = false;

    window.initCanvas = () => {
        const wrap = document.getElementById('canvasWrap');
        canvas.width = wrap.clientWidth;
        canvas.height = wrap.clientHeight;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        loadPage(currentPage);
    };

    const savePage = () => {
        pageData[currentPage].img = canvas.toDataURL();
        const tokens = [];
        document.querySelectorAll('.token').forEach(t => tokens.push({ text: t.innerText, x: t.style.left, y: t.style.top }));
        pageData[currentPage].tokens = tokens;
        localStorage.setItem('spice_canvas_data', JSON.stringify(pageData));
    };

    const loadPage = (idx) => {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        tokenLayer.innerHTML = "";
        const saved = JSON.parse(localStorage.getItem('spice_canvas_data'));
        if(saved) pageData = saved;

        if(pageData[idx].img) {
            const img = new Image(); img.src = pageData[idx].img;
            img.onload = () => ctx.drawImage(img, 0, 0);
        }
        pageData[idx].tokens.forEach(t => createTokenElement(t.text, t.x, t.y));
    };

    const tabs = document.getElementById('pageTabs');
    for(let i=0; i<10; i++) {
        const btn = document.createElement('button');
        btn.className = `page-btn ${i===0?'active':''}`;
        btn.innerText = `æˆ°åœ– ${i+1}`;
        btn.onclick = () => { savePage(); currentPage = i; document.querySelectorAll('.page-btn').forEach((b, k) => b.classList.toggle('active', k === i)); loadPage(i); };
        tabs.appendChild(btn);
    }

    canvas.addEventListener('pointerdown', (e) => {
        const r = canvas.getBoundingClientRect();
        const x = e.clientX - r.left; const y = e.clientY - r.top;
        if(window.currentTool === 'pen') { isDrawing = true; ctx.beginPath(); ctx.moveTo(x, y); }
        else if(window.currentTool === 'text') { const txt = prompt("æ¨™è¨˜æ–‡å­—ï¼š"); if(txt){ ctx.fillStyle = document.getElementById('inkColor').value; ctx.font = "bold 20px serif"; ctx.fillText(txt, x, y); savePage(); } }
    });
    canvas.addEventListener('pointermove', (e) => {
        if(!isDrawing || window.currentTool !== 'pen') return;
        const r = canvas.getBoundingClientRect();
        ctx.lineWidth = 2; ctx.strokeStyle = document.getElementById('inkColor').value;
        ctx.lineTo(e.clientX - r.left, e.clientY - r.top); ctx.stroke();
    });
    window.addEventListener('pointerup', () => { if(isDrawing){ isDrawing = false; savePage(); } });

    window.addToken = (name) => { createTokenElement(name, "50%", "50%"); savePage(); };
    function createTokenElement(name, x, y) {
        const t = document.createElement('div'); t.className = 'token'; t.innerText = name; t.style.left = x; t.style.top = y;
        t.onpointerdown = (e) => {
            let sX = e.clientX - t.getBoundingClientRect().left; let sY = e.clientY - t.getBoundingClientRect().top;
            function move(ev) { const r = document.getElementById('canvasWrap').getBoundingClientRect(); t.style.left = (ev.clientX - r.left - sX) + 'px'; t.style.top = (ev.clientY - r.top - sY) + 'px'; }
            document.addEventListener('pointermove', move);
            t.onpointerup = () => { document.removeEventListener('pointermove', move); t.onpointerup = null; savePage(); };
        };
        t.ondblclick = () => { if(confirm("ç§»é™¤æ­¤æ£‹å­ï¼Ÿ")){ t.remove(); savePage(); } };
        tokenLayer.appendChild(t);
    }

    // --- è§’è‰²ç·¨è¼¯é‚è¼¯ (å®Œå…¨ä¿®å¾©è‡³ system2.html ç‰ˆæœ¬) ---
    window.currentEditId = null;
    window.openCharCreate = () => {
        window.currentEditId = "char_" + Date.now();
        document.getElementById('modal-title').innerText = "å»ºç«‹æ–°èª¿æŸ¥å“¡æª”æ¡ˆ";
        document.querySelectorAll('#edit-modal input, #edit-modal textarea').forEach(i => i.value = "");
        document.getElementById('edit-modal').style.display = 'block';
    };

    window.editChar = async (id) => {
        window.currentEditId = id;
        const docRef = doc(db, "characters", id);
        const snap = await getDoc(docRef);
        if (snap.exists()) {
            const c = snap.data();
            document.getElementById('c-name').value = c.name;
            document.getElementById('c-s').value = c.s; document.getElementById('c-p').value = c.p;
            document.getElementById('c-i').value = c.i; document.getElementById('c-c').value = c.c;
            document.getElementById('c-e').value = c.e;
            document.getElementById('c-personality').value = c.personality;
            document.getElementById('c-background').value = c.background;
            document.getElementById('c-traits').value = c.traits;
            document.getElementById('modal-title').innerText = "ç·¨è¼¯èª¿æŸ¥å“¡ï¼š" + c.name;
            document.getElementById('edit-modal').style.display = 'block';
        }
    };

    window.deleteChar = async (id) => { if(confirm("ç¢ºå®šæ°¸ä¹…ç§»é™¤æ­¤èª¿æŸ¥å“¡ï¼Ÿ")) await deleteDoc(doc(db, "characters", id)); };
    window.closeModal = () => document.getElementById('edit-modal').style.display = 'none';

    document.getElementById('save-btn').onclick = async () => {
        const data = {
            name: document.getElementById('c-name').value || "ç„¡åæ°",
            s: parseInt(document.getElementById('c-s').value) || 0,
            p: parseInt(document.getElementById('c-p').value) || 0,
            i: parseInt(document.getElementById('c-i').value) || 0,
            c: parseInt(document.getElementById('c-c').value) || 0,
            e: parseInt(document.getElementById('c-e').value) || 0,
            personality: document.getElementById('c-personality').value || "æœªçŸ¥",
            background: document.getElementById('c-background').value || "æœªçŸ¥",
            traits: document.getElementById('c-traits').value || "ç„¡"
        };
        await setDoc(doc(db, "characters", window.currentEditId), data);
        window.closeModal();
    };

    onSnapshot(collection(db, "characters"), (snap) => {
        const grid = document.getElementById('charGrid'); grid.innerHTML = "";
        snap.forEach(d => {
            const c = d.data();
            grid.innerHTML += `
                <div class="char-card">
                    <h3 style="color:var(--accent); margin:0; font-size:1.5rem;">${c.name}</h3>
                    <div class="spice-bar">
                        <div class="spice-item"><div class="spice-label">S</div><div class="spice-val">${c.s}</div></div>
                        <div class="spice-item"><div class="spice-label">P</div><div class="spice-val">${c.p}</div></div>
                        <div class="spice-item"><div class="spice-label">I</div><div class="spice-val">${c.i}</div></div>
                        <div class="spice-item"><div class="spice-label">C</div><div class="spice-val">${c.c}</div></div>
                        <div class="spice-item"><div class="spice-label">E</div><div class="spice-val">${c.e}</div></div>
                    </div>
                    <div class="char-bio-section">
                        <span class="bio-label">æ€§æ ¼ç‰¹è³ª</span><p>${c.personality}</p>
                        <span class="bio-label">éš¨èº«ç‰©å“</span><p>${c.traits}</p>
                    </div>
                    <div style="margin-top:20px; border-top:1px solid #333; pt:15px; display:flex; gap:10px;">
                        <button onclick="window.checkAdmin(()=>window.editChar('${d.id}'))" style="flex:1; background:none; border:1px solid var(--accent); color:white; padding:8px; cursor:pointer; border-radius:4px;">ç·¨è¼¯è³‡æ–™</button>
                        <button onclick="window.checkAdmin(()=>window.deleteChar('${d.id}'))" style="background:none; border:none; color:#555; cursor:pointer;">åˆªé™¤</button>
                    </div>
                </div>`;
        });
    });

    // --- éª°å­æª¢å®šé‚è¼¯ (æ¢å¾©ç©©å®šç‰ˆ) ---
    window.rollDice = () => {
        const type = parseInt(document.getElementById('diceType').value);
        const target = parseInt(document.getElementById('targetVal').value);
        const isTesting = document.getElementById('useTarget').checked;
        const res = Math.floor(Math.random() * type) + 1;
        document.getElementById('resNum').innerText = res;
        const tag = document.getElementById('resTag');

        if(!isTesting) { tag.innerText = "ç´”çµæœæŠ•æ“²"; tag.style.color = "#94a3b8"; return; }

        if(type === 100) {
            if(res <= 5) { tag.innerText = "å¤§æˆåŠŸï¼"; tag.style.color = "#fbbf24"; }
            else if(res >= 96) { tag.innerText = "å¤§å¤±æ•—ï¼"; tag.style.color = "#f87171"; }
            else if(res <= target) { tag.innerText = "æª¢å®šé€šé"; tag.style.color = "var(--success)"; }
            else { tag.innerText = "æª¢å®šå¤±æ•—"; tag.style.color = "var(--fail)"; }
        } else {
            tag.innerText = res <= target ? "é”æˆç›®æ¨™" : "æœªé”æˆç›®æ¨™";
            tag.style.color = res <= target ? "var(--success)" : "var(--fail)";
        }
    };

    // --- æ—¥èªŒèˆ‡åŸºç¤åŠŸèƒ½ ---
    onSnapshot(doc(db, "system", "log"), (d) => { if(d.exists()) document.getElementById('log-content').innerText = d.data().text; });
    window.openLogEditor = () => { document.getElementById('full-log-textarea').value = document.getElementById('log-content').innerText; document.getElementById('log-editor-overlay').style.display='block'; };
    window.closeLogEditor = () => { document.getElementById('log-editor-overlay').style.display='none'; };
    window.saveLog = async () => { await setDoc(doc(db, "system", "log"), { text: document.getElementById('full-log-textarea').value }); window.closeLogEditor(); };
    window.showView = (id) => { document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); if(id === 'gm-zone') setTimeout(window.initCanvas, 100); };
    window.checkAdmin = (cb) => { if(prompt("ç®¡ç†è€…å¯†ç¢¼ï¼š") === "0921") cb(); else alert("å­˜å–é­æ‹’"); };
    window.clearCanvas = () => { if(confirm("æ¸…ç©ºç•¶å‰æˆ°åœ–ï¼Ÿ")){ ctx.clearRect(0,0,canvas.width,canvas.height); tokenLayer.innerHTML=""; savePage(); } };
</script>
</body>
</html>
